<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login - Hiper Saúde</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header>
    <h1>Área do Colaborador</h1>
    <p>Faça login para gerenciar seu perfil</p>
  </header>

  <nav>
    <a href="index.html">Voltar</a>
    <a href="#" onclick="showCadastro()">Cadastrar</a>
  </nav>

  <main>
    <div class="banner">
      <img src="https://images.unsplash.com/photo-1584982751601-97dcc096659c" 
           srcset="https://images.unsplash.com/photo-1584982751601-97dcc096659c?w=480 480w, https://images.unsplash.com/photo-1584982751601-97dcc096659c?w=1024 1024w"
           sizes="(max-width: 600px) 480px, (max-width: 1200px) 1024px, 1600px"
           alt="Banner Área do Colaborador">
    </div>
    <div class="container">
      <div class="item">
        <h2>Login</h2>
        <img src="https://images.unsplash.com/photo-1612349317150-e413f6a5b16d" 
             srcset="https://images.unsplash.com/photo-1612349317150-e413f6a5b16d?w=480 480w, https://images.unsplash.com/photo-1612349317150-e413f6a5b16d?w=1024 1024w"
             sizes="(max-width: 600px) 480px, (max-width: 1200px) 1024px, 1600px"
             alt="Imagem Login">
        <form id="loginForm">
          <label for="cpf">CPF:</label>
          <input type="text" id="cpf" required>
          <label for="password">Senha:</label>
          <input type="password" id="password" required>
          <button type="submit">Entrar</button>
        </form>
      </div>
    </div>

    <div id="cadastroPopup" class="popup">
      <div class="popup-content">
        <h2>Cadastro</h2>
        <form id="cadastroForm">
          <label for="nome">Nome:</label>
          <input type="text" id="nome" required>
          <label for="email">Email:</label>
          <input type="email" id="email" required>
          <label for="cpf">CPF:</label>
          <input type="text" id="cpf" required>
          <label for="password">Senha:</label>
          <input type="password" id="password" required>
          <button type="submit">Cadastrar</button>
          <button type="button" onclick="hideCadastro()">Fechar</button>
        </form>
      </div>
    </div>

    <div id="colaboradorPopup" class="popup">
      <div class="popup-content">
        <h2>Área do Colaborador</h2>
        <p id="userInfo"></p>
        <button onclick="showEditUser()">Editar Perfil</button>
        <button onclick="hideColaborador()">Fechar</button>
      </div>
    </div>

    <div id="editUserPopup" class="popup">
      <div class="popup-content">
        <h2>Editar Perfil</h2>
        <form id="editUserForm">
          <input type="hidden" id="editUserIndex">
          <label for="editNome">Nome:</label>
          <input type="text" id="editNome" required>
          <label for="editEmail">Email:</label>
          <input type="email" id="editEmail" required>
          <label for="editCpf">CPF:</label>
          <input type="text" id="editCpf" required>
          <label for="editPassword">Senha:</label>
          <input type="password" id="editPassword" required>
          <button type="submit">Salvar</button>
          <button type="button" onclick="hideEditUser()">Fechar</button>
        </form>
      </div>
    </div>
  </main>

  <footer>
    <p>© 2025 - Hiper Saúde Bauru e Região</p>
  </footer>

  <script>
    let users = JSON.parse(localStorage.getItem('users')) || [];
    let currentUser = JSON.parse(localStorage.getItem('currentUser'));

    function showCadastro() { document.getElementById("cadastroPopup").style.display = "flex"; }
    function hideCadastro() { document.getElementById("cadastroPopup").style.display = "none"; }
    function showColaborador() { 
      if (currentUser) {
        document.getElementById("userInfo").innerText = `Bem-vindo, ${currentUser.nome}! Email: ${currentUser.email}`;
        document.getElementById("colaboradorPopup").style.display = "flex";
      } else {
        alert('Nenhum usuário logado!');
      }
    }
    function hideColaborador() { document.getElementById("colaboradorPopup").style.display = "none"; }
    function showEditUser() {
      if (!currentUser) {
        alert('Nenhum usuário logado!');
        return;
      }
      const index = users.findIndex(u => u.cpf === currentUser.cpf);
      document.getElementById('editUserIndex').value = index;
      document.getElementById('editNome').value = currentUser.nome;
      document.getElementById('editEmail').value = currentUser.email;
      document.getElementById('editCpf').value = currentUser.cpf;
      document.getElementById('editPassword').value = currentUser.password;
      document.getElementById('editUserPopup').style.display = 'flex';
    }
    function hideEditUser() { document.getElementById("editUserPopup").style.display = "none"; }

    document.getElementById('loginForm').addEventListener('submit', function(event) {
      event.preventDefault();
      const cpf = document.getElementById('cpf').value;
      const password = document.getElementById('password').value;
      currentUser = users.find(u => u.cpf === cpf && u.password === password);
      if (currentUser) {
        localStorage.setItem('currentUser', JSON.stringify(currentUser));
        showColaborador();
      } else {
        alert('Credenciais inválidas!');
      }
    });

    document.getElementById('cadastroForm').addEventListener('submit', function(event) {
      event.preventDefault();
      const user = {
        nome: document.getElementById('nome').value,
        email: document.getElementById('email').value,
        cpf: document.getElementById('cpf').value,
        password: document.getElementById('password').value
      };
      if (users.some(u => u.email === user.email || u.cpf === user.cpf)) {
        alert('Email ou CPF já cadastrado!');
        return;
      }
      users.push(user);
      localStorage.setItem('users', JSON.stringify(users));
      alert('Cadastro realizado!');
      hideCadastro();
    });

    document.getElementById('editUserForm').addEventListener('submit', function(event) {
      event.preventDefault();
      const index = document.getElementById('editUserIndex').value;
      const email = document.getElementById('editEmail').value;
      const cpf = document.getElementById('editCpf').value;
      if (users.some((u, i) => i != index && (u.email === email || u.cpf === cpf))) {
        alert('Email ou CPF já cadastrado!');
        return;
      }
      const updatedUser = {
        nome: document.getElementById('editNome').value,
        email,
        cpf,
        password: document.getElementById('editPassword').value
      };
      users[index] = updatedUser;
      localStorage.setItem('users', JSON.stringify(users));
      localStorage.setItem('currentUser', JSON.stringify(updatedUser));
      currentUser = updatedUser;
      alert('Perfil atualizado!');
      hideEditUser();
      showColaborador();
    });
  </script>
</body>
</html>